# タスク作成APIテストシナリオ

## エンドポイント
`POST /api/v1/tasks`

## 概要
このテストシナリオでは、タスク作成APIの機能を検証します。ユーザーが新しいタスク（お願いごと）を作成する機能のテストケースを定義します。

## 前提条件
- テストユーザーが存在している
- テストユーザーがログインしている（有効なアクセストークンを持っている）

## テストケース

### TC-001: 正常系 - 必須項目のみでタスク作成
**入力**
- リクエストヘッダー: 有効なアクセストークン
- リクエストボディ:
```json
{
    "title": "部屋の掃除",
    "description": "リビングの掃除機かけと拭き掃除をお願いします",
    "category": "掃除",
    "priority": 2
}
```

**期待結果**
- ステータスコード: 201 Created
- レスポンスボディ: 作成されたタスク情報
  - id: 自動採番された値
  - user_id: リクエストしたユーザーのID
  - title: "部屋の掃除"
  - description: "リビングの掃除機かけと拭き掃除をお願いします"
  - category: "掃除"
  - priority: 2
  - status: "requested"（デフォルト値）
  - created_at: 現在日時
  - updated_at: 現在日時

### TC-002: 正常系 - すべての項目を指定してタスク作成
**入力**
- リクエストヘッダー: 有効なアクセストークン
- リクエストボディ:
```json
{
    "title": "スーパーでの買い物",
    "description": "牛乳、卵、パンを買ってきてください",
    "category": "買い物",
    "priority": 3,
    "scheduled_date": "2025-06-01"
}
```

**期待結果**
- ステータスコード: 201 Created
- レスポンスボディ: 作成されたタスク情報
  - 指定したすべての項目が反映されている
  - scheduled_date: "2025-06-01"
  - status: "requested"（デフォルト値）

### TC-003: 異常系 - 必須項目の欠落
**入力**
- リクエストヘッダー: 有効なアクセストークン
- リクエストボディ:
```json
{
    "category": "買い物",
    "priority": 1
}
```

**期待結果**
- ステータスコード: 422 Unprocessable Entity
- エラーメッセージ: title と description が必須であることを示すメッセージ

### TC-004: 異常系 - 無効な優先度
**入力**
- リクエストヘッダー: 有効なアクセストークン
- リクエストボディ:
```json
{
    "title": "窓拭き",
    "description": "窓をきれいに拭いてください",
    "priority": 10
}
```

**期待結果**
- ステータスコード: 422 Unprocessable Entity
- エラーメッセージ: 優先度の値が範囲外であることを示すメッセージ

### TC-005: 異常系 - 無効な日付形式
**入力**
- リクエストヘッダー: 有効なアクセストークン
- リクエストボディ:
```json
{
    "title": "庭の手入れ",
    "description": "庭の草取りをしてください",
    "scheduled_date": "2025/06/01"
}
```

**期待結果**
- ステータスコード: 422 Unprocessable Entity
- エラーメッセージ: 日付形式が無効であることを示すメッセージ

### TC-006: 異常系 - 未認証アクセス
**入力**
- リクエストヘッダー: アクセストークンなし
- リクエストボディ: 有効なタスクデータ

**期待結果**
- ステータスコード: 401 Unauthorized
- エラーメッセージ: 認証が必要であることを示すメッセージ

## モック設定
- データベースへのタスク挿入処理をモック化
- ユーザー認証システムをモック化

## 検証項目
- タスクが正しく作成されることの確認
- 必須フィールドのバリデーションの確認
- フィールド値の範囲チェックの確認
- 日付形式のバリデーションの確認
- デフォルト値（status="requested"など）の正しい設定
- 認証の検証
- エラーハンドリングの適切さ
